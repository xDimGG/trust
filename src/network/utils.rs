// ill-conceived functions that i had to copy from the source code

